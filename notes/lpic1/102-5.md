# Use RPM and YUM Package Management

We have already talked about package manager and repositories fundamentals in the
previous lesson [102-4](./102-4.md). Let's dive into the package managers for rpm-based
distros.

## rpm

rpm is a low-level package manager which operates on the `.rpm` files. You can use it
like: **rpm ACTION [OPTION] pkg.rpm**.

| Switch        | Description                                                       |
| ------------- | ----------------------------------------------------------------- |
| -i/--install  | Install a rpm package.                                            |
| -e/--erase    | Uninstall a rpm package.                                          |
| -U/--upgrade  | Install/Upgrade a rpm package (Mostly used for installation too). |
| -q/--query    | Check if a package is installed.                                  |
| -F/--freshen  | Only updates if it is already installed.                          |
| -V/--verify   | Check the integrity of the installation.                          |
| -K/--checksig | Check the integrity of an rpm package.                            |

> Most of the times when you have bunch of rpm files, you could do `rpm -Uvh *.rpm`.

When you know what you are doing, you can use `--nodeps` to prevent dependency check or
even use `--force` to force the installation/upgrade despite issues and complains.

You can query packages using `-q` switch. Here are some switches for the query switch:

| Switch           | Description                                               |
| ---------------- | --------------------------------------------------------- |
| -c/--configfiles | Show the package's configuration files                    |
| -i/--info        | Display detailed information about a package              |
| -a/--all         | Show all installed packages                               |
| --whatprovides   | Show which package provides a specific file or capability |
| -l/--list        | List all files installed by a package                     |
| -R/--requires    | Show dependencies required by a package                   |
| -f/--file        | Find which package owns a specific file                   |

> rpm removes a package without confirmation! Also it don't let a package that is a
> dependency of another package to be removed.

## yum

yum is a high-level package manager used in redhat-based systems. It stores
configuration at `/etc/yum.conf` and the repositories in `/etc/yum.repos.d/`.

**We use yum like: yum [OPTIONS] [COMMAND] [PACKAGE_NAME].**

| Command      | Description                                                              |
| ------------ | ------------------------------------------------------------------------ |
| update       | Update all the packages to the latest version available at repositories. |
| upgrade      | Like update but allows obsolete packages to be removed.                  |
| install      | Install a new package from repos.                                        |
| groupinstall | Install a group, like "KDE Plasma Workspaces".                           |
| localinstall | Install from a local rpm file.                                           |
| localupdate  | Update from a local rpm file.                                            |
| reinstall    | Reinstall a package.                                                     |
| remove       | Removes an installed package.                                            |
| provides     | Check which packages provide a specific file.                            |
| check-update | Check repositories for updates to be installed packages.                 |
| search       | Search a package in the repositories.                                    |
| list         | List installed packages.                                                 |
| info         | Get information about an installed package.                              |
| history      | Show the usage history.                                                  |

The metadata of yum/dnf are under: `/var/cache/yum(dnf)/*`.

> You can use wildcards in yum: `yum update "cal*"`.

Fedora uses `dnf` as its package manager so they translate yum commands to the dnf
equivalent.

> You can use `yumdownloader --resolve bzr` to download just the rpm packages. --resolve
> will download the dependencies rmp packages.

You can use rpm2cpio to turn rpm packages into an archive format named `cpio`.

```bash
rpm2cpio breezy-... > breezy.cpio
cpio -idv < breezy.pio
```

## zypper

zypper is another package manager for redhat-based distros. I actually don't find it
useful to include the commands of it. You would mostly use `dnf` in the real-world tasks
and you will search for the zypper commands or read the manuals. Also the commands are
pretty descriptive about what they do. Just remember that `lr` command shows repository
information.

## dnf

Nowadays, `dnf` is used as the package manager of most of the rpm-based distros.

```bash
dnf search tmux  # Search a package in repositories.
dnf install tmux  # Install a package with dependencies.
dnf remove tmux  # Uninstall a package. Remove unused dependencies.
dnf update  # Update all packages.

dnf clean all  # Clean everything.
dnf clean metadata  # Just clean metadata.
dnf clean packages  # Just clean the packages.

dnf repolist  # List the configured repositories.
dnf config-manager setopt <repo>  # Enable a repo.
dnf config-manager unsetopt <repo>  # Disable a repo.

dnf info tmux  # Give info about a package.

dnf group list  # List package groups.
dnf group install "Development Tools"  # Install a package group.
dnf group install "Development Tools"  # Remove a package group.
```

dnf caches live at: `/var/cache/dnf/`.

dnf repos are at: `/etc/yum.repos.d/`.
